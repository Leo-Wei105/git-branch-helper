# VSCode Git 分支快捷创建插件需求文档

## 1. 功能概述

一个用于快速创建标准化命名分支的VSCode插件，支持自定义分支前缀、自动生成分支名称、基分支选择等功能，提高开发效率。

### 1.1 核心价值
- **标准化分支命名**：统一团队分支命名规范
- **提高开发效率**：一键创建分支，减少重复操作
- **降低出错率**：自动化流程，避免手动输入错误
- **团队协作**：支持团队自定义配置

## 2. 分支命名规则

### 2.1 命名格式
```
前缀/日期/描述信息_Git用户名
```

### 2.2 示例
```
feature/20250604/用户登录功能_john
feat/20250604/修复登录bug_mary
bugfix/20250604/优化性能_alex
hotfix/20250604/紧急修复_李四
```

### 2.3 组成部分
- **前缀**：功能类型标识（feature、bugfix、hotfix等）
- **日期**：创建日期（yyyyMMdd格式）
- **描述信息**：简洁的功能描述
- **用户名**：Git用户名

## 3. 分支前缀管理

### 3.1 默认前缀配置
| 前缀 | 描述 | 是否默认 |
|------|------|----------|
| feature | 功能分支 | ✓ |
| feat | 功能分支简写 | |
| bugfix | 修复分支 | |
| hotfix | 热修复分支 | |
| fix | 修复分支简写 | |

### 3.2 自定义前缀功能
- ✅ 添加新前缀
- ✅ 编辑现有前缀描述
- ✅ 设置默认前缀
- ✅ 删除不需要的前缀
- ✅ 前缀验证（不能包含特殊字符）

## 4. 用户交互流程

### 4.1 触发方式
| 方式 | 快捷键/路径 | 说明 |
|------|-------------|------|
| 快捷键 | `Ctrl+Shift+F` (Win/Linux)<br>`Cmd+Shift+F` (Mac) | 全局快捷键 |
| 命令面板 | `Git: Create Feature Branch` | 命令面板搜索 |
| 源代码管理视图 | 添加快捷按钮 | SCM视图集成 |
| 右键菜单 | 资源管理器右键菜单 | 上下文菜单 |

### 4.2 操作步骤

#### 步骤1：分支前缀选择
```
显示快速选择面板
├── 单个前缀 → 自动使用
└── 多个前缀 → 显示选择列表
    ├── feature (功能分支) [默认]
    ├── feat (功能分支简写)
    ├── bugfix (修复分支)
    └── hotfix (热修复分支)
```

#### 步骤2：基分支选择
```
获取仓库所有分支
├── 本地分支优先显示
├── 远程分支可选
├── 默认选择当前分支
└── 支持搜索过滤
```

#### 步骤3：描述信息输入
```
显示输入框
├── 实时预览分支名称
├── 输入验证
├── 错误提示
└── 格式说明
```

#### 步骤4：确认创建
```
显示确认对话框
├── 基分支：main
├── 新分支：feature/20250604/用户登录功能_john
├── 描述：用户登录功能
└── [确认] [取消]
```

## 5. 输入验证规则

### 5.1 描述信息验证
- **允许字符**：字母、数字、中文、下划线(_)、短横线(-)
- **禁止字符**：空格、特殊符号
- **正则表达式**：`^[a-zA-Z0-9\u4e00-\u9fa5_-]+$`
- **长度限制**：1-50个字符

### 5.2 分支名称验证
- ❌ 不能包含连续斜杠 `//`
- ❌ 不能以斜杠开头或结尾
- ❌ 不能包含空格
- ✅ 检查分支是否已存在
- ✅ 符合Git分支命名规范

### 5.3 验证示例
```
✅ 有效输入：用户登录功能、fix-login-bug、user_management
❌ 无效输入：用户 登录、login@feature、空字符串
```

## 6. 配置管理

### 6.1 配置结构
```json
{
  "gitBranchCreator.branchPrefixes": [
    {
      "prefix": "feature",
      "description": "功能分支",
      "isDefault": true
    },
    {
      "prefix": "bugfix",
      "description": "修复分支",
      "isDefault": false
    }
  ],
  "gitBranchCreator.customGitName": "",
  "gitBranchCreator.dateFormat": "yyyyMMdd",
  "gitBranchCreator.autoCheckout": true
}
```

### 6.2 配置界面
- **VSCode设置页面**：集成到VSCode设置
- **可视化编辑**：表格形式编辑分支前缀
- **重置功能**：一键重置为默认配置
- **导入导出**：支持配置的导入导出

## 7. 技术实现要求

### 7.1 技术栈
- **开发语言**：TypeScript
- **框架**：VSCode Extension API
- **Git操作**：simple-git
- **构建工具**：webpack
- **测试框架**：Jest + @vscode/test-electron

### 7.2 核心依赖
```json
{
  "dependencies": {
    "simple-git": "^3.19.1",
    "moment": "^2.29.4"
  },
  "devDependencies": {
    "@types/vscode": "^1.74.0",
    "@typescript-eslint/eslint-plugin": "^5.45.0",
    "@typescript-eslint/parser": "^5.45.0",
    "eslint": "^8.28.0",
    "typescript": "^4.9.4"
  }
}
```

### 7.3 关键API使用
```typescript
// Git操作
const git = simpleGit(workspaceRoot);
const gitUserName = await git.getConfig('user.name');
const branches = await git.branchLocal();
await git.checkoutBranch(branchName, baseBranch);

// VSCode API
import * as vscode from 'vscode';
const selection = await vscode.window.showQuickPick(items);
const input = await vscode.window.showInputBox(options);
```

## 8. 用户体验设计

### 8.1 界面组件
- **快速选择面板**：分支前缀选择，支持键盘导航
- **下拉列表**：基分支选择，支持搜索过滤
- **输入框**：描述信息输入，实时验证
- **预览区域**：分支名称实时预览
- **确认对话框**：最终确认信息

### 8.2 反馈机制
- **成功提示**：分支创建成功的通知
- **错误提示**：详细错误信息和解决建议
- **进度指示**：长时间操作的进度显示
- **状态栏**：当前分支状态实时显示

### 8.3 用户体验优化
- **记住上次选择**：记住用户的前缀选择
- **智能建议**：基于历史记录提供建议
- **快捷操作**：ESC取消，Enter确认
- **无障碍支持**：支持屏幕阅读器

## 9. 扩展功能

### 9.1 分支模板系统
```typescript
// 自定义模板
const templates = {
  feature: "{prefix}/{date}/{description}_{username}",
  hotfix: "{prefix}/{date}/{description}_{username}",
  custom: "{prefix}_{date}_{description}"
};
```

### 9.2 批量操作
- **批量创建分支**：一次创建多个相关分支
- **分支前缀批量设置**：团队配置同步

### 9.3 集成功能
- **Issue集成**：自动关联GitHub/GitLab Issue
- **PR模板**：创建分支时生成PR模板
- **团队同步**：配置在团队间同步

## 10. 错误处理

### 10.1 错误类型
| 错误类型 | 处理策略 |
|----------|----------|
| Git仓库未找到 | 提示用户打开Git仓库 |
| 分支已存在 | 提供重命名或切换选项 |
| 网络异常 | 提供离线模式 |
| 权限不足 | 提供权限说明 |

### 10.2 错误恢复
```typescript
try {
  await git.checkoutBranch(branchName, baseBranch);
} catch (error) {
  vscode.window.showErrorMessage(
    `分支创建失败: ${error.message}`,
    '重试', '取消'
  );
}
```

## 11. 测试策略

### 11.1 单元测试
- ✅ 分支名称生成逻辑
- ✅ 输入验证功能
- ✅ 配置管理功能
- ✅ 工具函数测试

### 11.2 集成测试
- ✅ Git操作测试
- ✅ VSCode API集成测试
- ✅ 用户界面测试
- ✅ 配置持久化测试

### 11.3 端到端测试
- ✅ 完整创建分支流程
- ✅ 错误场景处理
- ✅ 用户交互测试

## 12. 国际化支持

### 12.1 支持语言
- 🇨🇳 中文 (zh-CN)
- 🇺🇸 英文 (en-US)
- 🇯🇵 日文 (ja-JP)

### 12.2 文本资源
```json
{
  "extension.createFeatureBranch": "创建功能分支",
  "extension.selectBranchPrefix": "选择分支前缀",
  "extension.selectBaseBranch": "选择基分支",
  "extension.enterDescription": "输入描述信息",
  "extension.invalidDescription": "描述信息格式无效",
  "extension.branchCreated": "分支创建成功",
  "extension.branchExists": "分支已存在"
}
```

## 13. 性能要求

### 13.1 性能指标
- **启动时间**：< 100ms
- **分支列表加载**：< 500ms
- **分支创建**：< 1000ms
- **内存占用**：< 10MB

### 13.2 性能优化
- **懒加载**：按需加载分支列表
- **缓存机制**：缓存Git配置和分支信息
- **防抖处理**：输入验证防抖
- **异步操作**：所有Git操作异步执行

## 14. 安全考虑

### 14.1 数据安全
- **输入验证**：防止注入攻击
- **权限控制**：仅访问必要的Git信息
- **数据加密**：敏感配置加密存储

### 14.2 隐私保护
- **本地存储**：配置仅本地存储
- **最小权限**：仅请求必要权限
- **数据清理**：卸载时清理配置

## 15. 部署发布

### 15.1 插件信息
- **插件名称**：Git Branch Creator
- **发布商**：您的名称
- **版本号**：1.0.0
- **分类**：SCM Providers
- **许可证**：MIT

### 15.2 发布流程
1. **开发测试**：完成功能开发和测试
2. **文档编写**：README和CHANGELOG
3. **打包发布**：使用vsce打包发布
4. **市场推广**：在VSCode Marketplace发布

### 15.3 市场展示
- **功能截图**：主要功能界面截图
- **演示GIF**：完整操作流程演示
- **详细说明**：功能特性详细说明
- **使用指南**：快速上手指南

## 16. 维护升级

### 16.1 版本规划
- **1.0.0**：基础功能实现
- **1.1.0**：增加批量操作
- **1.2.0**：集成Issue关联
- **2.0.0**：团队协作功能

### 16.2 反馈机制
- **GitHub Issues**：问题反馈和功能请求
- **用户调研**：定期用户体验调研
- **使用统计**：匿名使用数据统计

## 17. 开发时间表

### 17.1 开发阶段
| 阶段 | 时间 | 任务 |
|------|------|------|
| 需求分析 | 1周 | 完成需求文档 |
| 架构设计 | 1周 | 技术架构设计 |
| 核心开发 | 3周 | 核心功能开发 |
| 测试优化 | 2周 | 测试和性能优化 |
| 文档发布 | 1周 | 文档编写和发布 |

### 17.2 里程碑
- **Week 1**：需求确认和架构设计
- **Week 4**：核心功能开发完成
- **Week 6**：测试和优化完成
- **Week 8**：发布到市场

## 18. 总结

这个VSCode Git分支快捷创建插件将为开发者提供一个高效、标准化的分支创建工具，通过自动化流程减少重复操作，提高开发效率。插件具有良好的可扩展性和用户体验，支持团队协作和自定义配置。

### 18.1 关键优势
- 🚀 **提高效率**：一键创建标准化分支
- 📋 **规范统一**：团队分支命名规范
- 🎯 **简单易用**：直观的用户界面
- 🔧 **灵活配置**：支持自定义配置
- 🌍 **国际化**：多语言支持

### 18.2 成功指标
- **用户采用**：目标1000+活跃用户
- **用户满意**：4.5+星级评分
- **问题反馈**：<5%错误率
- **性能表现**：<1秒响应时间
